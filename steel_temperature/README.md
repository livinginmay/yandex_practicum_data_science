# Предсказание температуры стали

## Описание
Задача регрессии. В проекте рассмотрены 3 различных набора признаков для обучения и 5 моделей с подбором гиперпараметров на кросс-валидации – линейная регрессия, дерево решений, случайный лес, LightGBM, XGBoost. Выполнена генерация признаков, анализ их важности.

## Данные
Данные состоят из файлов, полученных из разных источников:
- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.
 
## Задача
Необходимо построить модель для предсказания финальной температуры стали. Цель - уменьшение потребления электроэнергии на этапе обработки стали для оптимизации производственных расходов металлургического комбината. Значение метрики MAE должно быть не более 8.7.
 

## Статус
Завершен

## Результат
Результатом работы над проектом стала модель, дающая значение MAE **5.7455** - на столько градусов ошибается предсказание финальной температуры на тестовой выборке. 

Лучшая модель - **LightGBM**, максимальная глубина дерева **max_depth = 6**, количество деревьев **n_estimators = 95, random_state = 250722**, обучена на следующих признаках:
1. `sum_heat_time` - файл `data_arc.csv`, рассчитать разницы в секундах между датами в колонках "Начало нагрева дугой" и "Конец нагрева дугой", сложить полученные числа по полю `key`; 
2. `sum_full_power` - файл `data_arc.csv`, рассчитать общую мощность по формуле
$$
\sqrt{(active)^2 + (reactive)^2}
$$
где active - данные колонки "Активная мощность", reactive - данные колонки "Реактивная мощность", далее сложить полученные результаты по полю `key`;
3. `sum_active_power` - файл `data_arc.csv`, сложить данные в колонке "Активная мощность" по полю `key`; 
4. `all_time` - файл `data_arc.csv`, разница в секундах между минимальным значением в колонке "Начало нагрева дугой" и максимальным значением в колонке "Конец нагрева дугой" по полю `key`;
5. `pause_time` - расчет по формуле `all_time` - `sum_heat_time`; 
6. `bulk_1` - файл `data_bulk.csv`, колонка "Bulk 1"; 
7. `bulk_3` - файл `data_bulk.csv`, колонка "Bulk 3"; 
8. `bulk_4` - файл `data_bulk.csv`, колонка "Bulk 4"; 
9. `bulk_6` - файл `data_bulk.csv`, колонка "Bulk 6"; 
10. `bulk_7` - файл `data_bulk.csv`, колонка "Bulk 7"; 
11. `bulk_12` - файл `data_bulk.csv`, колонка "Bulk 12"; 
12. `bulk_14` - файл `data_bulk.csv`, колонка "Bulk 14"; 
13. `bulk_15` - файл `data_bulk.csv`, колонка "Bulk 15"; 
14. `gas_1` - файл `data_gas.csv`, колонка "Газ 1"; 
15. `wire_1` - файл `data_wire.csv`, колонка "Wire 1"; 
16. `wire_2` - файл `data_wire.csv`, колонка "Wire 2"; 
17. `temperature_1` - файл `data_temp.csv`, значение в колонке "Температура" по минимальной дате из колонки "Время замера".

Целевой признак `temperature_final` - файл `data_temp.csv`, значение в колонке "Температура" по максимальной дате из колонки "Время замера".

Данные разных таблиц соединяются по полю `key`, при этом берутся строки, по которым конкретный `key` есть во всех таблицах и значения `temperature_1` и `temperature_final` заполнены. Остальные пропуски заполняются нулями.

## Используемые библиотеки
*Python, Pandas, PandaSQL, Scikit-learn, LightGBM, XGBoost, Seaborn*
